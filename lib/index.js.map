{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;qBA4CwB,WAAW;;;;;sBArCX,QAAQ;;;;sBACR,UAAU;;;;;;;;AAM3B,SAAS,KAAK,CAAC,KAAK,EAAE;AAC3B,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;;;AAG5B,QAAM,CAAC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;AAC/B,QAAM,CAAC,MAAM,GAAG,oBAAO,IAAI,CAAC,KAAK,CAAC,CAAC;;;AAGnC,QAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAA,GAAG;WAAI,KAAK,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC;GAAA,CAAC,CAAC;AACzD,QAAM,CAAC,EAAE,CAAC,OAAO,EAAE,UAAA,GAAG;WAAI,KAAK,CAAC,IAAI,CAAC,cAAc,EAAE,GAAG,CAAC;GAAA,CAAC,CAAC;AAC3D,QAAM,CAAC,EAAE,CAAC,SAAS,EAAE,UAAA,GAAG;WAAI,KAAK,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC;GAAA,CAAC,CAAC;AAC/D,QAAM,CAAC,EAAE,CAAC,UAAU,EAAE,UAAA,GAAG;WAAI,KAAK,CAAC,IAAI,CAAC,iBAAiB,EAAE,GAAG,CAAC;GAAA,CAAC,CAAC;;;AAGjE,MAAM,IAAI,GAAG,SAAP,IAAI,GAAc;AACtB,UAAM,CAAC,IAAI;;AAET;aAAM,OAAO,CAAC,IAAI,EAAE;KAAA,CACrB,CAAC;GACH,CAAC;AACF,SAAO,CAAC,EAAE,CAAC,SAAS,EAAY,IAAI,CAAC,CAAC;AACtC,SAAO,CAAC,EAAE,CAAC,QAAQ,EAAa,IAAI,CAAC,CAAC;AACtC,SAAO,CAAC,EAAE,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;CAEvC;;;;;;AAMc,SAAS,WAAW,CAAC,KAAK,EAAkB;MAAhB,GAAG,yDAAG,QAAQ;;AAEvD,OAAK,CAAC,IAAI,CAAC,YAAW;AACpB,QAAI,CAAC,MAAM,GAAG,wBAAW,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;AAC3C,SAAK,CAAC,IAAI,CAAC,CAAC;GACb,CAAC,CAAC;CAEJ","file":"index.js","sourcesContent":["/**\n * index.js\n *\n * @author  Denis Luchkin-Zhou <denis@ricepo.com>\n * @license MIT\n */\n\nimport Agenda      from 'agenda';\nimport Define      from './define';\n\n\n/*!\n * Setup agenda to play well with Ignis\n */\nexport function setup(ignis) {\n  const agenda = ignis.agenda;\n\n  /* agenda.define() on steroids */\n  agenda._define = agenda.define;\n  agenda.define = Define.bind(ignis);\n\n  /* Emit agenda events via Ignis dispatcher */\n  agenda.on('fail', job => ignis.emit('agenda.fail', job));\n  agenda.on('start', job => ignis.emit('agenda.start', job));\n  agenda.on('success', job => ignis.emit('agenda.success', job));\n  agenda.on('complete', job => ignis.emit('agenda.complete', job));\n\n  /* Watch for process termination and gracefully shutdown */\n  const stop = function() {\n    agenda.stop(\n      /* istanbul ignore next */\n      () => process.exit()\n    );\n  };\n  process.on('SIGTERM',           stop);\n  process.on('SIGINT',            stop);\n  process.on('uncaughtException', stop);\n\n}\n\n\n/*!\n * Ignis extension function.\n */\nexport default function IgnisAgenda(Ignis, key = 'agenda') {\n\n  Ignis.init(function() {\n    this.agenda = new Agenda(this.config(key));\n    setup(this);\n  });\n\n}\n"],"sourceRoot":"/source/"}
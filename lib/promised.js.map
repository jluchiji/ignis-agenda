{"version":3,"sources":["promised.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;qBAOwB,OAAO;;;;yBACP,YAAY;;IAAxB,IAAI;;AAEhB,IAAM,KAAK,GAAG,wBAAM,qBAAqB,CAAC,CAAC;;;;;;;AAOpC,SAAS,cAAc,CAAC,IAAI,EAAE;;;;;;AAGnC,MAAI,IAAI,CAAC,UAAU,EAAE;AAAE,QAAI,GAAG,IAAI,WAAQ,CAAC;GAAE;;;cAGJ,IAAI;MAArC,IAAI,SAAJ,IAAI;4BAAE,OAAO;MAAP,OAAO,iCAAG,EAAG;MAAE,OAAO,SAAP,OAAO;;AACpC,OAAK,CAAC,IAAI,CAAC,CAAC;;AAEZ,MAAM,QAAQ,GAAG,SAAX,QAAQ,CAAI,GAAG,EAAE,IAAI;WAAK,OAAO,QAAO,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC;GAAA,CAAC;AACzE,MAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;CAE/D;;qBAGc,UAAS,KAAK,EAAE;AAC7B,OAAK,CAAC,MAAM,CAAC,cAAc,GAAG,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;CAC1D","file":"promised.js","sourcesContent":["/**\n * promised.js\n *\n * @author  Denis Luchkin-Zhou <denis@ricepo.com>\n * @license MIT\n */\n\nimport Debug       from 'debug';\nimport * as Util   from 'ignis-util';\n\nconst debug = Debug('ignis:agenda:define');\n\n\n/*!\n * Defines a promised task handler.\n * XXX Bind to Ignis instance, not agenda\n */\nexport function definePromised(task) {\n\n  /* Allow ES6 modules */\n  if (task.__esModule) { task = task.default; }\n\n  /* Setup wrapped task */\n  const { name, options = { }, handler } = task;\n  debug(name);\n\n  const callback = (job, done) => handler(this, job.attrs.data, job, done);\n  this.agenda.define(name, options, Util.unpromisify(callback));\n\n}\n\n\nexport default function(ignis) {\n  ignis.agenda.definePromised = definePromised.bind(ignis);\n}\n"],"sourceRoot":"/source/"}